name: schwab_connect_test

on:
  workflow_dispatch: {}
  # optional daily ping on weekdays (off-hours)
  schedule:
    - cron: "15 13 * * 1-5"

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: |
          python -m pip install --upgrade pip
          pip install schwab-py pandas
      - name: Run Schwab connectivity test
        env:
          SCHWAB_APP_KEY:    ${{ secrets.SCHWAB_APP_KEY }}
          SCHWAB_APP_SECRET: ${{ secrets.SCHWAB_APP_SECRET }}
          SCHWAB_TOKEN_JSON: ${{ secrets.SCHWAB_TOKEN_JSON }}
          # Optional if you want to test an option quote too:
          # TEST_OCC:          ${{ secrets.TEST_OCC }}
        run: |
          python scripts/trade/accelerator/test_schwab_connect.py
